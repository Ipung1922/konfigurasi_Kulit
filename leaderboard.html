<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Papan Skor - Konfigurasi Elektron</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  </head>
  <body
    class="bg-gradient-to-br from-green-50 via-white to-blue-50 min-h-screen"
  >
    <div class="container mx-auto py-12 max-w-3xl text-center">
      <h1 class="text-4xl font-bold text-green-800 mb-8">🏆 Papan Skor</h1>

      <table class="min-w-full bg-white shadow-md rounded-xl overflow-hidden">
        <thead class="bg-green-600 text-white">
          <tr>
            <th class="py-3 px-4">Peringkat</th>
            <th class="py-3 px-4">Nama</th>
            <th class="py-3 px-4">Skor</th>
            <th class="py-3 px-4">Tanggal</th>
          </tr>
        </thead>
        <tbody id="leaderboardTable"></tbody>
      </table>

      <button
        onclick="location.href='latihan.html'"
        class="mt-8 bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition-all"
      >
        🔙 Kembali ke Quiz
      </button>
    </div>

    <script>
      // Konfigurasi Firebase (gunakan yang sama)
      const firebaseConfig = {
        apiKey: "AIzaSyA9QXVUPhObbf0mWJ24pHDIVTzAjW4FjaQ",
        authDomain: "kuis-29a9b.firebaseapp.com",
        databaseURL: "https://kuis-29a9b-default-rtdb.firebaseio.com",
        projectId: "kuis-29a9b",
        storageBucket: "kuis-29a9b.firebasestorage.app",
        messagingSenderId: "879477573039",
        appId: "1:879477573039:web:e9368951ded947a8975b5a",
      };

      // Inisialisasi Firebase
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();

      // Ambil data dari Firebase dan urutkan
      function loadLeaderboard() {
        const tableBody = document.getElementById("leaderboardTable");
        tableBody.innerHTML =
          "<tr><td colspan='4' class='py-4'>⏳ Memuat data...</td></tr>";

        database
          .ref("scores/default")
          .orderByChild("score")
          .limitToLast(10) // ambil 10 skor tertinggi
          .once("value", (snapshot) => {
            const data = [];
            snapshot.forEach((child) => {
              data.push(child.val());
            });

            // Urutkan dari skor tertinggi ke rendah
            data.sort((a, b) => b.score - a.score);

            // Tampilkan ke tabel
            tableBody.innerHTML = "";
            data.forEach((item, index) => {
              const date = new Date(item.timestamp).toLocaleDateString("id-ID");
              const rankEmoji =
                index === 0
                  ? "🥇"
                  : index === 1
                  ? "🥈"
                  : index === 2
                  ? "🥉"
                  : index + 1;

              tableBody.innerHTML += `
                <tr class="border-b hover:bg-green-50">
                  <td class="py-3 px-4 font-bold">${rankEmoji}</td>
                  <td class="py-3 px-4">${item.name}</td>
                  <td class="py-3 px-4 text-green-700 font-semibold">${item.score}</td>
                  <td class="py-3 px-4 text-gray-600">${date}</td>
                </tr>
              `;
            });
          });
      }

      // Jalankan saat halaman dimuat
      document.addEventListener("DOMContentLoaded", loadLeaderboard);
    </script>
  </body>
</html>
